#!/usr/bin/env bash
# service list from: https://gist.github.com/haircut/aeb22c853b0ae4b483a76320ccc8c8e9
set -euo pipefail
IFS=$'\n\t'

SERVICES=(
    "Accessibility"
    "AddressBook"
    "All"
    "AppleEvents"
    "Calendar"
    "Camera"
    "ContactsFull"
    "ContactsLimited"
    "Facebook"
    "FileProviderDomain"
    "FileProviderPresence"
    "LinkedIn"
    "Liverpool"
    #"Location" why this fail?
    "MediaLibrary"
    "Microphone"
    "Motion"
    "Photos"
    "PhotosAdd"
    "PostEvent"
    "Reminders"
    "ScreenCapture"
    "ShareKit"
    "SinaWeibo"
    "Siri"
    "SpeechRecognition"
    "SystemPolicyAllFiles"
    "SystemPolicyDesktopFolder"
    "SystemPolicyDeveloperFiles"
    "SystemPolicyDocumentsFolder"
    "SystemPolicyNetworkVolumes"
    "SystemPolicyRemovableVolumes"
    "SystemPolicySysAdminFiles"
    "SystemPolicyDownloadsFolder"
    "TencentWeibo"
    "Twitter"
    "Ubiquity"
    "Willow"
)

case ${1:-} in
    all)
    for service in ${SERVICES[@]}; do
        tccutil reset $service
    done
    ;;

    core)
    tccutil reset AddressBook
    tccutil reset Calendar
    tccutil reset Reminders
    tccutil reset Photos
    tccutil reset SystemPolicyAllFiles
    tccutil reset SystemPolicyDesktopFolder
    tccutil reset SystemPolicyDocumentsFolder
    ;;

    *)
    echo >&2 "Usage: $0 all|core"
    exit 1
esac
